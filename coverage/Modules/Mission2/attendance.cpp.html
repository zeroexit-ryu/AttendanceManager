<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
        <meta charset="utf-8"/>
	    <title>attendance.cpp</title>
	    <link href="../../third-party/google-code-prettify/prettify-CppCoverage.css" type="text/css" rel="stylesheet" />
	    <script type="text/javascript" src="../../third-party/google-code-prettify/prettify.js"></script>
	</head>
    <body onload="prettyPrint()">
        <h4></h4>
        <pre class="prettyprint lang-cpp linenums">
#include &lt;iostream&gt;
#include &lt;fstream&gt;
#include &lt;string&gt;
#include &lt;vector&gt;
#include &lt;map&gt;
#include &lt;algorithm&gt;
#include &lt;cassert&gt;

#include "gmock/gmock.h"

using namespace std;

#define interface struct

interface Grade{
public:
	virtual bool isPass() = 0;
};

interface GradeFactoryInterface{
public:
	virtual Grade * getGrade() = 0;
};

class GoldGrade : public Grade {
public:
<span style = "background-color:#dfd">	bool isPass() override { return true; }</span>
};

class SilverGrade : public Grade {
public:
<span style = "background-color:#dfd">	bool isPass() override { return true; }</span>
};

class GoldGradeFactory : public GradeFactoryInterface {
public:
<span style = "background-color:#dfd">	Grade* getGrade() override {
		return new GoldGrade();
	}</span>
};
class SilverGradeFactory : public GradeFactoryInterface {
public:
<span style = "background-color:#dfd">	Grade* getGrade() override {
		return new SilverGrade();
	}</span>
};

class NormalGrade : public Grade {
public:
<span style = "background-color:#dfd">	bool isPass() override { return false; }</span>
};

class NormalGradeFactory : public GradeFactoryInterface {
public:
<span style = "background-color:#dfd">	Grade* getGrade() override {
		return new NormalGrade();
	}</span>
};

class GradeFactory {
public:
<span style = "background-color:#dfd">	static GradeFactory&amp; getInstance() {
		static GradeFactory instance;
		return instance;
	}</span>

<span style = "background-color:#dfd">	Grade* createGrade(int point) {
		GradeFactoryInterface* factory = nullptr;
		int prevFactoryPoint = 0;
		for (auto it = mapPointGradeFactory.begin(); it != mapPointGradeFactory.end(); ++it) {
			if (point &gt;= it-&gt;first) {
				if (point &gt; prevFactoryPoint)</span>
				{
<span style = "background-color:#dfd">					factory = it-&gt;second;
					prevFactoryPoint = it-&gt;first;</span>
				}
<span style = "background-color:#dfd">			}
		}</span>

<span style = "background-color:#dfd">		assert(factory != nullptr);</span>

<span style = "background-color:#dfd">		if (factory != nullptr) return factory-&gt;getGrade();</span>

<span style = "background-color:#fdd">		return nullptr;		</span>
<span style = "background-color:#dfd">	}</span>

<span style = "background-color:#dfd">	void addGradeFactory(int point, GradeFactoryInterface* factory) {
		mapPointGradeFactory.insert({ point, factory });
	}</span>
private:
<span style = "background-color:#dfd">	GradeFactory() {}</span>
	GradeFactory&amp; operator=(const GradeFactory&amp; other) = delete;
	GradeFactory(const GradeFactory&amp; other) = delete;

	map&lt;int, GradeFactoryInterface*&gt; mapPointGradeFactory;
};

const int GOLD_MEMBER_POINT = 50;
const int SILVER_MEMBER_POINT = 30;
const int NORMAL_MEMBER_POINT = 0;

<span style = "background-color:#dfd">TEST(TS1, GRADE_FACTORY_TEST)
{
	GradeFactory::getInstance().addGradeFactory(GOLD_MEMBER_POINT, new GoldGradeFactory);
	GradeFactory::getInstance().addGradeFactory(SILVER_MEMBER_POINT, new SilverGradeFactory);
	GradeFactory::getInstance().addGradeFactory(NORMAL_MEMBER_POINT, new NormalGradeFactory);</span>

<span style = "background-color:#dfd">	EXPECT_EQ(true, GradeFactory::getInstance().createGrade(63)-&gt;isPass());
	EXPECT_EQ(true, GradeFactory::getInstance().createGrade(33)-&gt;isPass());
	EXPECT_EQ(false, GradeFactory::getInstance().createGrade(25)-&gt;isPass());
}</span>

const int WEEKDAYNUM = 7;

class Attendance {
public:
	int attendance[WEEKDAYNUM];
	int wednesdayAttendance;
	int weekendAttendance;
};

class Player {
public:
	string name;
	int backNumber;

	Grade* grade;
	Attendance* attendance;
};



// 0. grade initialize
// 1. read file
// 2. create player and calc attendance count
// 3. calc point
// 4. get grade
// 5. print player list
// 6. print fail player list

class Point {

};

struct Node {
	string w;
	string wk;
};

<span style = "background-color:#dfd">map&lt;string, int&gt; mapNameID;</span>
int idCount = 0;



enum GRADE {
	NORMAL = 0,
	GOLD = 1,
	SILVER = 2
};

struct PlayerAttendance {
	string name;
	int attendance[WEEKDAYNUM];
	int points;
	GRADE grade;
	int wednesdayAttendance;
	int weekendAttendance;
};

const int MAX_PLAYERS = 100;

<span style = "background-color:#dfd">PlayerAttendance playerAttendance[MAX_PLAYERS];</span>

//attendanceData[ì¬ì©ìID][ìì¼]
int attendanceData[100][100];
int points[100];
int grade[100];
<span style = "background-color:#dfd">string names[100];</span>
int wednesday[100];
int weekend[100];

enum WeekDay
{
	MONDAY = 0,
	TUESDAY,
	WEDNESDAY,
	THURSDAY,
	FRIDAY,
	SATURDAY,
	SUNDAY
};

void getWeekdayAndPoint(std::string&amp; weekday, WeekDay&amp; weekdayIndex, int&amp; add_point, int idNum);

void printRemovePlayers();

void printPlayerInfo(int idNum);

void applyGrade(int idNum);

void applyBonusPoints(int idNum);

<span style = "background-color:#fdd">void calcWeekdayPoints(string name, string weekday) {</span>
	//ID ë¶ì¬
<span style = "background-color:#fdd">	if (mapNameID.count(name) == 0) {
		mapNameID.insert({ name, ++idCount });
		names[idCount] = name;</span>
	}
<span style = "background-color:#fdd">	int idNum = mapNameID[name];</span>

<span style = "background-color:#fdd">	int add_point = 0;
	WeekDay weekdayIndex = MONDAY;</span>

<span style = "background-color:#fdd">	getWeekdayAndPoint(weekday, weekdayIndex, add_point, idNum);</span>

	//ì¬ì©ìIDë³ ìì¼ ë°ì´í°ì 1ì© ì¦ê°
<span style = "background-color:#fdd">	attendanceData[idNum][weekdayIndex] += 1;
	points[idNum] += add_point;
}</span>

void getWeekdayAndPoint(std::string&amp; weekday, WeekDay&amp; weekdayIndex, int&amp; add_point, int idNum)
<span style = "background-color:#fdd">{
	if (weekday == "monday") {
		weekdayIndex = MONDAY;
		add_point++;</span>
	}
<span style = "background-color:#fdd">	if (weekday == "tuesday") {
		weekdayIndex = TUESDAY;
		add_point++;</span>
	}
<span style = "background-color:#fdd">	if (weekday == "wednesday") {
		weekdayIndex = WEDNESDAY;
		add_point += 3;
		wednesday[idNum] += 1;</span>
	}
<span style = "background-color:#fdd">	if (weekday == "thursday") {
		weekdayIndex = THURSDAY;
		add_point++;</span>
	}
<span style = "background-color:#fdd">	if (weekday == "friday") {
		weekdayIndex = FRIDAY;
		add_point++;</span>
	}
<span style = "background-color:#fdd">	if (weekday == "saturday") {
		weekdayIndex = SATURDAY;
		add_point += 2;
		weekend[idNum] += 1;</span>
	}
<span style = "background-color:#fdd">	if (weekday == "sunday") {
		weekdayIndex = SUNDAY;
		add_point += 2;
		weekend[idNum] += 1;</span>
	}
<span style = "background-color:#fdd">}</span>

<span style = "background-color:#fdd">void processData() {
	ifstream fin{ "attendance_weekday_500.txt" }; //500ê° ë°ì´í° ìë ¥
	for (int i = 0; i &lt; 500; i++) {
		string name, weekday;
		fin &gt;&gt; name &gt;&gt; weekday;
		calcWeekdayPoints(name, weekday);
	}</span>

<span style = "background-color:#fdd">	for (int idNum = 1; idNum &lt;= idCount; idNum++) {
		applyBonusPoints(idNum);
		applyGrade(idNum);</span>

<span style = "background-color:#fdd">		printPlayerInfo(idNum);
	}</span>

<span style = "background-color:#fdd">	std::cout &lt;&lt; "\n";
	printRemovePlayers();
}</span>

const int BONUS_ATTENDANCE_COUNT = 9;
const int BONUS_ATTENDANCE_POINT = 10;

void applyBonusPoints(int idNum)
<span style = "background-color:#fdd">{
	if (attendanceData[idNum][WEDNESDAY] &gt; BONUS_ATTENDANCE_COUNT) {
		points[idNum] += BONUS_ATTENDANCE_POINT;</span>
	}

<span style = "background-color:#fdd">	if (attendanceData[idNum][SATURDAY] + attendanceData[idNum][SUNDAY] &gt; BONUS_ATTENDANCE_COUNT) {
		points[idNum] += BONUS_ATTENDANCE_POINT;</span>
	}
<span style = "background-color:#fdd">}</span>

void applyGrade(int idNum)
<span style = "background-color:#fdd">{
	if (points[idNum] &gt;= GOLD_MEMBER_POINT) {
		grade[idNum] = GOLD;
	}
	else if (points[idNum] &gt;= SILVER_MEMBER_POINT) {
		grade[idNum] = SILVER;
	}</span>
	else {
<span style = "background-color:#fdd">		grade[idNum] = NORMAL;</span>
	}
<span style = "background-color:#fdd">}</span>

void printPlayerInfo(int idNum)
<span style = "background-color:#fdd">{
	cout &lt;&lt; "NAME : " &lt;&lt; names[idNum] &lt;&lt; ", ";
	cout &lt;&lt; "POINT : " &lt;&lt; points[idNum] &lt;&lt; ", ";
	cout &lt;&lt; "GRADE : ";</span>

<span style = "background-color:#fdd">	if (grade[idNum] == GOLD) {
		cout &lt;&lt; "GOLD" &lt;&lt; "\n";
	}
	else if (grade[idNum] == SILVER) {
		cout &lt;&lt; "SILVER" &lt;&lt; "\n";
	}</span>
	else {
<span style = "background-color:#fdd">		cout &lt;&lt; "NORMAL" &lt;&lt; "\n";</span>
	}
<span style = "background-color:#fdd">}</span>

void printRemovePlayers()
<span style = "background-color:#fdd">{
	std::cout &lt;&lt; "Removed player\n";
	std::cout &lt;&lt; "==============\n";
	for (int i = 1; i &lt;= idCount; i++) {
		if (grade[i] != GOLD &amp;&amp; grade[i] != SILVER &amp;&amp; wednesday[i] == 0 &amp;&amp; weekend[i] == 0) {
			std::cout &lt;&lt; names[i] &lt;&lt; "\n";</span>
		}
<span style = "background-color:#fdd">	}
}</span>

<span style = "background-color:#dfd">int main(int argc, char* argv[]) {</span>
#ifdef _DEBUG
<span style = "background-color:#dfd">	::testing::InitGoogleMock();
	return RUN_ALL_TESTS();</span>
#else
	processData();
	return 0;
#endif
<span style = "background-color:#dfd">}</span></pre>
        <hr />
        <table width="100%">
            <thead>
                <tr>
                    <th align="center">
                        <small>Generated by</small>
                        <a href="https://github.com/OpenCppCoverage/OpenCppCoverage/releases">
                            <strong>OpenCppCoverage (Version: 0.9.9.0)</strong>
                        </a>
                    </th>
                </tr>
            </thead>
        </table>
    </body>
</html>